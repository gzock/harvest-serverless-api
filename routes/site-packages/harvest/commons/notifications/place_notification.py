from harvest.commons.notifications.notification import Notification

class PlaceNotification(Notification):

  def __init__(self, stream_record, host, port):
    super().set_record_type("場所")
    super().__init__(stream_record, host, port)
 
  def select_message(self):
    if self.is_insert_event:
      self.message = self.create
      self.notify_users = self.get_notify_users("all")

    elif self.is_modify_event:
      if self.old_record["name"] != self.record["name"]:
        self.message = self.update
        self.notify_users = self.get_notify_users("all")

    elif self.is_remove_event:
      self.message = self.delete
      self.notify_users = self.get_notify_users("all")

    return self.message

  def generate(self):
    self.needs_strings_dict.update(
      {
        "name": self.record["name"]
      }
    )
    if self.is_modify_event:
      self.needs_strings_dict.update(
        {
          "old_name": self.old_record["name"]
        }
      )
    return super().generate()
