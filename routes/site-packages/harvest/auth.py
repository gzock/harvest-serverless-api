from harvest.role_controller import RoleController

class Auth():
  __user_id = ""
  __project_id = ""
  my_role = ""
  __roles = ["guest", "worker", "admin", "owner"]

  def __init__(self, host, port, user_id, project_id):
    print("auth inner")
    print(user_id)
    print(project_id)
    self.__role = RoleController(host, port)
    self.set_user_id(user_id)
    ret = self.set_project_id(project_id)
    print(ret)
    if ret:
      self.my_role = ret["role"]
    #return [ item["project_id"] for item in self.role.list_projects() ]

  def set_user_id(self, user_id):
    self.__user_id = str(user_id)
    return self.__role.set_user_id(str(user_id))

  def set_project_id(self, project_id):
    self.__project_id = str(project_id)
    return self.__role.set_project_id(str(project_id))

  def get_role(self):
    return self.my_role

  def guard(self, role=None):
    print("guard inner: " + str(self.my_role))
    if not self.my_role:
      return False

    if role:
      print(role)
      if self.__roles.index(role) > self.__roles.index(self.my_role):
        return False

    return True
