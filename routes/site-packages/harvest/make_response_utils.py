import json
import decimal

def make_response_headers_for_cors():
  return {
      "Access-Control-Allow-Headers": "Content-Type,Authorization,X-Amz-Date,X-Api-Key,X-Amz-Security-Token",
      "Access-Control-Allow-Methods": "OPTIONS,GET,POST,PUT,DELETE",
      "Access-Control-Allow-Origin": "*"
  }
  
def make_base_error_obj():
  return {
    "error": {
      "code": 0,
      "message": "",
      "ref_url": ""
    }
  }


def make_response(status_code=200, body=None, exception=None):
  headers = make_response_headers_for_cors()

  if status_code >= 400:
    body = make_base_error_obj()
    if exception:
      pass
    else:
      body["error"]["code"] = 999
      body["error"]["message"] = "Unknown error."

  return {
      "statusCode": status_code,
      "headers": headers,
      "body": json.dumps(body, cls = DecimalEncoder)
  }

class DecimalEncoder(json.JSONEncoder):
  def default(self, o):
    if isinstance(o, decimal.Decimal):
      return int(o)
    return super(DecimalEncoder, self).default(o)
